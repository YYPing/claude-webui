# Claude Code Web UI - 测试计划

**项目**: Claude Code Web UI  
**测试负责人**: QA  
**创建时间**: 2025-02-11 01:30  
**测试范围**: P0 核心功能  

---

## 1. 测试目标

确保 Claude Code Web UI 的核心功能正常运行，能够准确读取和展示 Claude Code 本地数据。

---

## 2. 测试环境

### 2.1 运行环境
- **前端**: http://localhost:5173/
- **后端**: http://localhost:3001/
- **Claude Code**: 运行中 (PID: 36070)
- **数据源**: ~/.claude/

### 2.2 测试数据
- 历史记录: ~/.claude/history.jsonl (24条消息)
- 会话数: 3个
- Agents: 4个 (PM, FE, BE, QA)

---

## 3. 测试用例

### 3.1 后端 API 测试

#### TC-API-001: 健康检查 API
**测试步骤**:
1. 发送 GET 请求到 /api/health
2. 检查返回状态码
3. 检查返回数据格式

**期望结果**:
- 状态码: 200
- 返回: `{"status":"ok","timestamp":<number>}`

**实际结果**: ✅ PASS
```json
{"status":"ok","timestamp":1770744407735}
```

---

#### TC-API-002: Claude Code 状态检测
**测试步骤**:
1. 发送 GET 请求到 /api/status
2. 检查返回的运行状态
3. 验证 PID、CPU、内存数据

**期望结果**:
- 状态码: 200
- status: "running"
- 包含 pid, cpu, memory, time 字段

**实际结果**: ✅ PASS
```json
{
  "status": "running",
  "pid": "36070",
  "cpu": "25.6%",
  "memory": "3.4%",
  "time": "52:49.55"
}
```

---

#### TC-API-003: 历史记录 API
**测试步骤**:
1. 发送 GET 请求到 /api/history
2. 检查会话列表
3. 检查消息列表
4. 验证数据结构

**期望结果**:
- 状态码: 200
- sessions 数组不为空
- messages 数组不为空

**实际结果**: ✅ PASS
- 会话数: 3
- 消息数: 24
- 数据结构正确

---

#### TC-API-004: Agents API
**测试步骤**:
1. 发送 GET 请求到 /api/agents
2. 检查 Agents 列表
3. 验证每个 Agent 的字段

**期望结果**:
- 状态码: 200
- agents 数组长度 = 4
- 每个 agent 包含: name, description, allowedTools

**实际结果**: ✅ PASS
- Agents: 4个 (PM, FE, BE, QA)
- 字段完整

---

#### TC-API-005: 权限 API
**测试步骤**:
1. 发送 GET 请求到 /api/permissions
2. 检查权限列表

**期望结果**:
- 状态码: 200
- permissions.allow 数组不为空

**实际结果**: ⏳ 待测试

---

#### TC-API-006: MCP API
**测试步骤**:
1. 发送 GET 请求到 /api/mcp
2. 检查 MCP 列表

**期望结果**:
- 状态码: 200
- mcps 数组（可能为空）

**实际结果**: ⏳ 待测试

---

### 3.2 前端界面测试

#### TC-UI-001: Dashboard 页面加载
**测试步骤**:
1. 打开 http://localhost:5173/
2. 检查页面是否正常加载
3. 检查 Header 是否显示

**期望结果**:
- 页面正常加载
- 显示 "Claude Code Web UI" 标题
- 显示 Claude 运行状态

**实际结果**: ⏳ 待测试

---

#### TC-UI-002: Claude Code 状态显示
**测试步骤**:
1. 查看 Dashboard 顶部状态卡片
2. 验证状态指示器
3. 检查 PID、CPU、内存显示

**期望结果**:
- 显示 🟢 运行中
- 显示正确的 PID、CPU、内存数据

**实际结果**: ⏳ 待测试

---

#### TC-UI-003: 统计卡片显示
**测试步骤**:
1. 查看三个统计卡片
2. 验证会话数统计
3. 验证当前 Agent 显示

**期望结果**:
- 显示总会话数
- 显示当前 Agent
- 显示工作目录

**实际结果**: ⏳ 待测试

---

#### TC-UI-004: Agent 列表显示
**测试步骤**:
1. 查看 Agent 卡片
2. 验证 4 个 Agents 都显示
3. 检查工具数量标签

**期望结果**:
- 显示 PM, FE, BE, QA
- 每个显示工具数量

**实际结果**: ⏳ 待测试

---

#### TC-UI-005: 会话列表显示
**测试步骤**:
1. 查看最近会话列表
2. 验证会话标题
3. 检查时间显示

**期望结果**:
- 显示至少 1 个会话
- 显示消息数量
- 显示相对时间

**实际结果**: ⏳ 待测试

---

### 3.3 功能测试

#### TC-FUNC-001: 自动刷新
**测试步骤**:
1. 打开 Dashboard
2. 等待 5 秒
3. 观察状态是否自动刷新

**期望结果**:
- 每 5 秒自动刷新状态
- 无需手动刷新页面

**实际结果**: ⏳ 待测试

---

#### TC-FUNC-002: 点击会话查看详情
**测试步骤**:
1. 点击某个会话
2. 切换到会话详情 Tab
3. 查看消息时间线

**期望结果**:
- 能够切换 Tab
- 显示消息详情
- 显示时间线

**实际结果**: ⏳ 待测试

---

#### TC-FUNC-003: Tab 切换
**测试步骤**:
1. 点击不同的 Tab (Dashboard, 会话详情, 权限, MCP)
2. 验证页面切换

**期望结果**:
- Tab 正常切换
- 内容正确显示

**实际结果**: ⏳ 待测试

---

## 4. 冒烟测试 (Smoke Test)

### 4.1 快速验证清单

| 项目 | 状态 | 备注 |
|------|------|------|
| 后端服务启动 | ✅ PASS | http://localhost:3001 |
| 前端服务启动 | ✅ PASS | http://localhost:5173 |
| /api/health | ✅ PASS | 返回 ok |
| /api/status | ✅ PASS | 检测到 Claude 运行 |
| /api/history | ✅ PASS | 3个会话，24条消息 |
| /api/agents | ✅ PASS | 4个 Agents |
| 前端页面加载 | ⏳ 待测 | 需手动测试 |

---

## 5. 缺陷报告

### 5.1 缺陷列表

| ID | 严重度 | 描述 | 状态 | 发现时间 |
|----|--------|------|------|----------|
| - | - | 暂无 | - | - |

---

## 6. 测试进度

### 6.1 完成情况

- **后端 API 测试**: 4/6 (67%)
- **前端界面测试**: 0/5 (0%)
- **功能测试**: 0/3 (0%)

**总体进度**: 4/14 (29%)

---

## 7. 下一步

1. ✅ 完成剩余 API 测试
2. 🔲 执行前端界面测试（需浏览器）
3. 🔲 执行功能测试
4. 🔲 记录测试结果
5. 🔲 编写测试报告

---

**最后更新**: 2025-02-11 01:30  
**测试负责人**: QA  
**状态**: 🟡 进行中  
